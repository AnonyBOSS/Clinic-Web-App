{"version":3,"sources":["../../../../../../Downloads/ClincsManagmentSystem/app/doctor/dashboard/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\n\r\ninterface DoctorSchedule {\r\n  day: string;\r\n  start_time: string;\r\n  end_time: string;\r\n}\r\n\r\nexport default function DoctorDashboard() {\r\n  const router = useRouter();\r\n  const [user, setUser] = useState<any>(null);\r\n  const [schedule, setSchedule] = useState<DoctorSchedule[]>([]);\r\n  const [appointments, setAppointments] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState('schedule');\r\n  const [selectedDate, setSelectedDate] = useState('');\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    const userRole = localStorage.getItem('userRole');\r\n    const userStr = localStorage.getItem('user');\r\n\r\n    if (!token || userRole !== 'doctor') {\r\n      router.push('/doctor/login');\r\n      return;\r\n    }\r\n\r\n    if (userStr) {\r\n      const parsedUser = JSON.parse(userStr);\r\n      setUser(parsedUser);\r\n      fetchDoctorData(parsedUser.id);\r\n    }\r\n  }, []);\r\n\r\n  const fetchDoctorData = async (doctorId: string) => {\r\n    try {\r\n      const today = new Date().toISOString().split('T')[0];\r\n      const response = await fetch(\r\n        `/api/doctors/${doctorId}?date=${today}`\r\n      );\r\n      const data = await response.json();\r\n      setSchedule(data.schedule || []);\r\n      setAppointments(data.appointments || []);\r\n      setSelectedDate(today);\r\n    } catch (error) {\r\n      console.error('Error fetching doctor data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('user');\r\n    localStorage.removeItem('userRole');\r\n    router.push('/');\r\n  };\r\n\r\n  const handleDateChange = async (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const date = e.target.value;\r\n    setSelectedDate(date);\r\n\r\n    try {\r\n      const response = await fetch(\r\n        `/api/doctors/${user.id}?date=${date}`\r\n      );\r\n      const data = await response.json();\r\n      setAppointments(data.appointments || []);\r\n    } catch (error) {\r\n      console.error('Error fetching appointments:', error);\r\n    }\r\n  };\r\n\r\n  if (!user) return <div className=\"text-center py-12\">Loading...</div>;\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto px-4 py-12\">\r\n      <div className=\"flex justify-between items-center mb-8\">\r\n        <h1 className=\"text-4xl font-bold\">Doctor Dashboard</h1>\r\n        <button\r\n          onClick={handleLogout}\r\n          className=\"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700\"\r\n        >\r\n          Logout\r\n        </button>\r\n      </div>\r\n\r\n      {/* Profile Card */}\r\n      <div className=\"bg-white rounded-lg shadow p-6 mb-8\">\r\n        <h2 className=\"text-2xl font-bold mb-4\">Welcome, Dr. {user.full_name}!</h2>\r\n        <p className=\"text-gray-600 mb-2\">\r\n          <strong>Email:</strong> {user.email}\r\n        </p>\r\n        <p className=\"text-gray-600\">\r\n          <strong>Specializations:</strong>{' '}\r\n          {user.specializations?.join(', ') || 'General Practice'}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"mb-6 flex space-x-4\">\r\n        <button\r\n          onClick={() => setActiveTab('schedule')}\r\n          className={`px-4 py-2 rounded ${\r\n            activeTab === 'schedule'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200'\r\n          }`}\r\n        >\r\n          Today's Schedule\r\n        </button>\r\n        <button\r\n          onClick={() => setActiveTab('manage')}\r\n          className={`px-4 py-2 rounded ${\r\n            activeTab === 'manage'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200'\r\n          }`}\r\n        >\r\n          Manage Schedule\r\n        </button>\r\n      </div>\r\n\r\n      {/* Schedule Tab */}\r\n      {activeTab === 'schedule' && (\r\n        <div>\r\n          <div className=\"bg-white rounded-lg shadow p-6 mb-6\">\r\n            <label className=\"block text-gray-700 font-bold mb-2\">\r\n              Select Date\r\n            </label>\r\n            <input\r\n              type=\"date\"\r\n              value={selectedDate}\r\n              onChange={handleDateChange}\r\n              className=\"px-4 py-2 border border-gray-300 rounded\"\r\n            />\r\n          </div>\r\n\r\n          {appointments.length === 0 ? (\r\n            <div className=\"bg-white rounded-lg shadow p-6 text-center\">\r\n              <p className=\"text-gray-600\">No appointments for this date</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {appointments.map((appointment) => (\r\n                <div key={appointment._id} className=\"bg-white rounded-lg shadow p-6\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div>\r\n                      <p className=\"font-bold\">\r\n                        {appointment.patient_id?.full_name}\r\n                      </p>\r\n                      <p className=\"text-gray-600 text-sm\">\r\n                        Patient ID: {appointment.patient_id?._id}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-bold\">\r\n                        {appointment.clinic_id?.name}\r\n                      </p>\r\n                      <p className=\"text-gray-600 text-sm\">\r\n                        Room {appointment.room_id?.room_number}\r\n                      </p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-sm\">\r\n                        <strong>Status:</strong>{' '}\r\n                        <span className=\"capitalize text-blue-600\">\r\n                          {appointment.status}\r\n                        </span>\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Manage Schedule Tab */}\r\n      {activeTab === 'manage' && (\r\n        <div className=\"bg-white rounded-lg shadow p-6\">\r\n          <h2 className=\"text-2xl font-bold mb-4\">Manage Working Schedule</h2>\r\n          <p className=\"text-gray-600 mb-4\">\r\n            Current Schedule:\r\n          </p>\r\n          {schedule.length > 0 ? (\r\n            <div className=\"space-y-2\">\r\n              {schedule.map((day, idx) => (\r\n                <div key={idx} className=\"border border-gray-200 p-3 rounded\">\r\n                  <p className=\"font-bold\">{day.day}</p>\r\n                  <p className=\"text-gray-600\">\r\n                    {day.start_time} - {day.end_time}\r\n                  </p>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <p className=\"text-gray-600\">No schedule set</p>\r\n          )}\r\n          <p className=\"text-gray-600 mt-4\">Schedule management coming soon...</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}